<h2 class="apunte__titulo-h2">
    JSON
</h2>

<p class="apunte__parrafo">
    JavaScript Object Notation (JSON) es el formato de texto estándar para representar
    estructuras de información (objetos, arrays) basado en la sintaxis de los objetos
    de JavaScript. Una de sus principales funciones es transmitir información a
    través de la web, enviando o recibiendo datos. Puede ser usado independientemente de JavaScript.
</p>

<p class="apunte__parrafo">
    El proceso de convertir un string a un objeto es llamado "deserialization",
    mientras que el proceso de convertir un objeto a un string es llamado "serialization".
</p>

<p class="apunte__parrafo">
    Un JSON "string" puede ser almacenado en su propio archivo, el cual es
    básicamente un archivo de texto con la extensión ".json".
</p>

<h3 class="apunte__titulo-h3">Estructura de JSON</h3>

<p class="apunte__parrafo">
    El contenido de un archivo ".json" es un string cuyo
    formato es muy parecido al de los "object literals" en JavaScript.
</p>

<figure class="figure">
    <figcaption class="figure__titulo">Ejemplo estructura JSON</figcaption>
    <pre class="codigo__bloque"><span>
{
    "nombre": "dowo",
    "edad": 24,
    "sexo": "hombre",
    "vivo": true
}</span></pre>
</figure>

<p class="apunte__parrafo">
    Es posible cargar un archivo ".json" en nuestro programa como un
    "string", luego por medio de un método del "JSON object" convertirlo a un
    objeto y finalmente acceder a la información en este objeto como haríamos con cualquier otro.
</p>

<p class="apunte__parrafo">
    Un archivo ".json" puede contener arrays, objetos o combinaciones de estos en cualquier
    complejidad, pero estará definido principalmente por su envoltorio principal:
</p>
<ul class="lista-desordenada">
    <li class="lista-desordenada__elemento">
        Contenido entre <code>{}</code>: Se trata como objeto
    </li>
    <li class="lista-desordenada__elemento">
        Contenido entre <code>[]</code>: Se trata como array
    </li>
</ul>

<p class="apunte__parrafo">
    Los ".json" también pueden contener datos primitivos como números, strings o booleanos.
</p>

<h3 class="apunte__titulo-h3">Restricciones de sintaxis</h3>

<p class="apunte__parrafo">
    Los archivos ".json" válidos pueden contener valores primitivos, objetos o arrays,
    pero con las siguientes restricciones:
</p>
<ul class="lista-desordenada">
    <li class="lista-desordenada__elemento">
        Solo acepta object literals, arrays o valores primitivos (strings, números, true, false y null)
    </li>
    <li class="lista-desordenada__elemento">
        No acepta "undefined", "NaN" o infinito
    </li>
    <li class="lista-desordenada__elemento">
        No acepta funciones u otros tipos de objeto
    </li>
    <li class="lista-desordenada__elemento">
        Strings deben usar comillas dobles, no simples
    </li>
    <li class="lista-desordenada__elemento">
        Números deben escribirse en notación decimal
    </li>
    <li class="lista-desordenada__elemento">
        Miembros de objetos deben tener formato: <code>"miembro": valor</code>
    </li>
    <li class="lista-desordenada__elemento">
        Sin comas finales en objetos o arrays
    </li>
    <li class="lista-desordenada__elemento">
        Sin comentarios permitidos
    </li>
</ul>

<p class="apunte__parrafo">
    Romper estas reglas hace que un documento ".json" sea inválido. Existen herramientas para validar JSON.
</p>

<h3 class="apunte__titulo-h3">Conversión entre objetos y texto</h3>

<p class="apunte__parrafo">Métodos principales para conversión:</p>

<dl class="lista-descriptiva">
    <div class="lista-descriptiva__bloque">
        <dt class="lista-descriptiva__titulo">
            JSON.parse()
        </dt>
        <dd class="lista-descriptiva__descripcion">
            Acepta un string JSON como parámetro y devuelve el objeto JavaScript correspondiente
        </dd>
    </div>
    <div class="lista-descriptiva__bloque">
        <dt class="lista-descriptiva__titulo">
            JSON.stringify()
        </dt>
        <dd class="lista-descriptiva__descripcion">
            Acepta un objeto como parámetro y devuelve un string JSON
        </dd>
    </div>
</dl>

<h3 class="apunte__titulo-h3">Async/Await</h3>

<p class="apunte__parrafo">"async" y "await" son palabras clave en JavaScript para manejar operaciones asíncronas:</p>

<dl class="lista-descriptiva">
    <div class="lista-descriptiva__bloque">
        <dt class="lista-descriptiva__titulo">
            Async
        </dt>
        <dd class="lista-descriptiva__descripcion">
            Indica que una función será asíncrona, permitiendo pausar su ejecución sin afectar el resto de la página
        </dd>
    </div>
    <div class="lista-descriptiva__bloque">
        <dt class="lista-descriptiva__titulo">
            Await
        </dt>
        <dd class="lista-descriptiva__descripcion">
            Espera el resultado de una operación asíncrona, generalmente almacenando resultados en promesas
        </dd>
    </div>
</dl>

<figure class="figure">
    <figcaption class="figure__titulo">Ejemplo async/await</figcaption>
    <pre class="codigo__bloque"><code>
async function obtenerClima() { 
    // Palabra clave async indica función asíncrona
    
    try { 
        // Bloque try para código que podría generar errores
        const datos = await datosClima(); 
        // await pausa hasta obtener resultado de la promesa
        
        mostrarClima(datos); 
        // Se ejecuta si todo es correcto
    
    } catch(error) { 
        // Bloque catch maneja errores
        manejarError(error); 
    
    } finally {  
        // Bloque finally siempre se ejecuta
        console.log("Proceso finalizado");
    }
}</code></pre>
</figure>